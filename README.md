# TRIBE API Examples

Official examples for using the TRIBE API.

## Quick Start

```bash
# Install dependencies
npm install

# Set your API key
export TRIBE_API_KEY="sk_live_your_key_here"

# Set your TRIBE API base URL (default: http://localhost:8080)
export TRIBE_API_BASE="http://localhost:8080"

# Run examples
node examples/generate-insight.js
node examples/insights.js
node examples/events.js
node examples/batch-events.js
```

## Examples Included

- **generate-insight.js** - Generate AI-powered insights from usage data
- **insights.js** - Fetch and display analytics insights
- **events.js** - Track custom events
- **batch-events.js** - Track multiple events efficiently
- **knowledge-base.js** - Search knowledge base articles
- **webhooks.js** - Set up webhook listeners (coming soon)

## API Endpoints

### Generate AI Insight

**Endpoint:** `POST http://localhost:8080/api/insights/generate`

**Headers:**
```json
{
  "Authorization": "Bearer sk_live_...",
  "Content-Type": "application/json"
}
```

**Request Body:**
```json
{
  "insight_type": "usage_analysis",
  "time_period": "7d",
  "metadata": {
    "focus_area": "productivity"
  }
}
```

**Response:**
```json
{
  "success": true,
  "insight": {
    "id": "uuid",
    "provider": "kimi",
    "title": "AI-Powered Insight",
    "description": "Generated by Kimi AI",
    "value": "Analysis summary",
    "recommendation": "Actionable recommendation",
    "event_scores": [
      {"event_id": 0, "relevance": 8}
    ]
  },
  "user_id": "user_id_from_api_key"
}
```

### Ingest Telemetry Events

**Endpoint:** `POST http://localhost:8080/api/telemetry/ingest`

**Headers:**
```json
{
  "Authorization": "Bearer sk_live_...",
  "Content-Type": "application/json"
}
```

**Request Body:**
```json
{
  "events": [
    {
      "event_type": "user",
      "tool": "claude_code",
      "project_path": "/path/to/project",
      "message_text": "Event description"
    }
  ]
}
```

**Response:**
```json
{
  "success": true,
  "events_processed": 1,
  "user_id": "user_id_from_api_key"
}
```

## Documentation

Full API documentation: https://tribecode.ai/docs/api

## Authentication

The TRIBE Tutor API supports API key authentication for programmatic access:

### API Key Format
- Live keys: `sk_live_...`
- Test keys: `sk_test_...`

### Creating API Keys

API keys are stored in the database with SHA256 hashing. Create one with:

```sql
INSERT INTO api_keys (key_hash, user_id, name) VALUES (
  encode(sha256('sk_live_your_actual_key'::bytea), 'hex'),
  'your_user_id',
  'API Key Name'
);
```

### Using API Keys

Include your API key in the `Authorization` header:

```javascript
fetch('http://localhost:8080/api/insights/generate', {
  headers: {
    'Authorization': 'Bearer sk_live_your_key_here',
    'Content-Type': 'application/json'
  }
});
```

## Support

- Email: api-support@tribecode.ai
- Docs: https://docs.tribecode.ai
- Issues: https://github.com/TRIBE-INC/tribe-api/issues
